<!DOCTYPE html>

<meta charset="utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta property="og:url" content="http://www.viennar.org/">


<meta property="og:type" content="article">
<meta property="og:title" content="igraph Applications for Transportation Networks &middot; Vienna R User Group">

<meta property="og:site_name" content="Vienna R User Group">

<title>
    
    igraph Applications for Transportation Networks
    
</title>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/github.min.css">
<link rel="stylesheet" href="http://www.viennar.org//css/styles.css">
<link rel="stylesheet" href="http://www.viennar.org//css/custom.css">

<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed|Roboto' rel='stylesheet' type='text/css'>


<link rel="shortcut icon" href="http://www.viennar.org//assets/favicon.ico">


<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.viennar.org//index.xml">


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div class="container">
    <header class="nav">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://www.viennar.org/">Vienna R User Group</a>
                </div>

                <div class="collapse navbar-collapse" id="navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="http://www.viennar.org//post">All Posts</a></li>
                        <li><a href="http://www.viennar.org//tags">Tags</a></li>
                        
                    </ul>

                    <ul class="nav navbar-nav navbar-right">
                        
                        <li>
                            <a href="https://www.meetup.com/viennar" target="_blank">
                                <i class="fa fa-arrows"></i>
                                Meetup</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="https://twitter.com/ViennaR" target="_blank">
                                <i class="fa fa-twitter-square"></i>
                                Twitter</a>
                        </li>
                        
                        
                        <li>
                            <a href="https://github.com/ViennaR" target="_blank">
                                <i class="fa fa-github-square"></i>
                                GitHub
                            </a>
                        </li>
                        
                        
                        <li>
                            <a href="https://www.linkedin.com/in/viennar" target="_blank">
                                <i class="fa fa-linkedin-square"></i>
                                LinkedIn
                            </a>
                        </li>
                        
                        <li>
                            <a href="http://www.viennar.org//index.xml" type="application/rss+xml" target="_blank">
                                <i class="fa fa-rss"></i>
                                RSS
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>


<div class="row">
    <div class="col-md-8">
        <article class="post">

            <header>
                <div class="post-date">
                    <span class="glyphicon glyphicon-calendar"></span>
                    <time datetime="Wed, Aug 24, 2016">
                        Wed, Aug 24, 2016
                    </time>
                </div>
                <h1 class="post-title">
                    <a href="http://www.viennar.org/blog/2016/08/24/igraph-applications-for-transportation-networks/">igraph Applications for Transportation Networks</a>
                </h1>
            </header>

            <div class="post-content">
                <p>Materials from Max Leodolters talk in May covering the <strong>igraph</strong>
package.</p>

<pre><code>require(igraph)
require(data.table)
require(ggplot2)
</code></pre>

<p></p>

<ul>
<li><a href="#centrality---what-is-it">Centrality - What is it?</a></li>
<li><a href="#igraph-for-centralities">igraph for centralities</a>

<ul>
<li><a href="#node-betweenness">Node Betweenness</a></li>
<li><a href="#local-vs.-global">Local vs. Global</a></li>
<li><a href="#node-based-vs.-link-based-betweenness-for-links">Node-based vs. link-based Betweenness for
Links</a></li>
<li><a href="#bugsfeaturesspecial-experiences">Bugs/Features/Special
experiences</a></li>
</ul></li>
<li><a href="#what-for-did-we-use-centralities">What for did we use
centralities?</a>

<ul>
<li><a href="#global-betweenness">Global Betweenness</a></li>
<li><a href="#local-betweenness">Local Betweenness</a></li>
<li><a href="#global-closeness">Global Closeness</a></li>
<li><a href="#local-closeness">Local Closeness</a></li>
<li><a href="#real-world-difference-of-node-based-and-link-based-betweenness-for-a-link">Real world difference of node-based and link-based Betweenness
for a
link</a></li>
<li><a href="#improvement-travel-time-model">Improvement travel time model</a></li>
</ul></li>
</ul>

<h1 id="centrality-what-is-it">Centrality - What is it?</h1>

<p>Network Centrality gives you an idea of how important a vertex/node and
edge/link in your network/graph <em>N</em>(<em>V</em>, <em>E</em>) respectively <em>G</em>(<em>N</em>, <em>L</em>)
is. Examples:</p>

<ul>
<li>Closeness</li>
<li>Betweenness</li>
<li>Eigenvalue</li>
<li>degree</li>
<li>&hellip;</li>
</ul>

<p>Some formulas:</p>

<ul>
<li>Closeness Centrality
$$ C^{node}(n) = \frac{1}{\sum_{m \in N \setminus \{n\}}d(n,m)} $$</li>
<li>Betweenness centrality
$$ B^{node}(n) = \sum_{m\neq o \in N\backslash \{n\} } \frac{\sigma_{mo}(n)}{\sigma_{mo}} $$</li>
<li>Node-based Closeness for a link
$$ \ddot{C}^{link}(l_{n,m}) = \frac{C^{node}(n) + C^{node}(m)}{2} $$</li>
<li>Node-based Betweenness for a link
$$ \ddot{B}^{link}(l_{n,m}) = \frac{B^{node}(n) + B^{node}(m)}{2} $$</li>
<li>Link-based Betweenness for a link
$$ B^{link}(l) = \sum_{n \neq m \in N } \frac{\sigma_{nm}(l)}{\sigma_{nm}} $$
 *<em>σ</em> is the number of traversing OD relations, and <em>d</em>(<em>n</em>, <em>m</em>)
is the distance of the shortest route from <em>n</em> to <em>m</em></li>
</ul>

<p>What to select, $\ddot{B}^{link}(l_{n,m})$ or $ B^{link}(l)$?</p>

<h1 id="igraph-for-centralities">igraph for centralities</h1>

<h2 id="node-betweenness">Node Betweenness</h2>

<pre><code>g &lt;- make_star(5, mode = &quot;undirected&quot;, center=3)
V(g)$name &lt;- letters[1:length(V(g))]
plot(g)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-2-1.png" alt="" /></p>

<pre><code>g &lt;- set.edge.attribute(g, &quot;weight&quot;,  value= 1)
b &lt;- betweenness(g, directed=F)
V(g)$name &lt;- b
plot(g)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-2-2.png" alt="" /></p>

<p>Edge Betweenness:</p>

<pre><code>g &lt;- make_star(5, mode = &quot;undirected&quot;, center=3)
V(g)$name &lt;- letters[1:length(V(g))]
g &lt;- set.edge.attribute(g, &quot;weight&quot;,  value= 1)

bg &lt;- edge_betweenness(g, directed=F)
plot(g, edge.label = bg)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-3-1.png" alt="" /></p>

<h2 id="local-vs-global">Local vs. Global</h2>

<pre><code>g &lt;- make_graph(c(1, 2, 2, 3,#horizontal connections
                  4,5,5,6,6,7,
                  1,6,#vertical connections
                  2,7), directed = FALSE)
#g &lt;- make_star(10, mode = &quot;undirected&quot;, center=3)
V(g)$name &lt;- letters[1:length(V(g))]
g &lt;- set.edge.attribute(g, &quot;weight&quot;,  value= 1)
set.seed(2)
lay &lt;- layout.auto(g)
bl &lt;- estimate_edge_betweenness(g, cutoff = 1.5, directed=F);bl

## [1] 3 3 2 4 3 3 3

bg &lt;- edge_betweenness(g, directed=F)


# set plotting parameters
vs &lt;- 15# vertex.size
ec &lt;- gray(0.8)#edge.color
elx &lt;- 2# edge.label.cex
elc &lt;- &quot;black&quot;#,edge.label.color
vlc &lt;- 2#vertex.label.cex
ew &lt;- 2#edge.width
hd &lt;- paste(rep(&quot; &quot;,0), collapse=&quot;&quot;)
cm &lt;- 3
vc &lt;- &quot;orange&quot;#gray(0.8)#palette(&quot;default&quot;)#&quot;grey&quot;#vertex.color

#windows(width = 18, height=6)
#par(mfrow=c(1,3))

plot(g, edge.label=paste(hd, round(E(g)$weight,1)), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(a) Weights&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-4-1.png" alt="" /></p>

<pre><code>plot(g, edge.label=paste(hd, round(bl,1)),          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) Local Betweenness&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-4-2.png" alt="" /></p>

<pre><code>plot(g, edge.label=paste(hd, round(bg,1)),          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(c) Global Betweenness&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-4-3.png" alt="" /></p>

<h2 id="node-based-vs-link-based-betweenness-for-links">Node-based vs. link-based Betweenness for Links</h2>

<pre><code>g &lt;- make_graph(c(1,2, 2,3, 3,4, 4,5,#horizontal connections
                  6,7, 7,8, 8,9, 9,10,
                  2,7,#vertical connections
                  3,8,
                  4,9), directed = FALSE)

V(g)$name &lt;- letters[1:length(V(g))]
set.seed(1210)
g &lt;- set.edge.attribute(g, &quot;weight&quot;,  value= 1)
g &lt;- set.edge.attribute(g, &quot;weight&quot;, index= c(10), value= 2)
#plot(g,edge.label=paste(hd, round(E(g)$weight,1)))
lay &lt;- layout.auto(g)
eb &lt;- edge_betweenness(g, directed=F)
vb &lt;- betweenness(g, directed=F)

tmp1 &lt;- as.data.table(as.data.frame(cbind(get.edgelist(g))))
tmp1[,id:=1:.N]
tmp2 &lt;- as.data.table(data.frame(value=vb, name=names(vb)))
setnames(tmp1, &quot;V1&quot;, &quot;name&quot;)
tmp3 &lt;- merge(tmp1, tmp2, by =&quot;name&quot;)
setnames(tmp3, &quot;name&quot;, &quot;V1&quot;)
setnames(tmp3, &quot;V2&quot;, &quot;name&quot;)
tmp4 &lt;- merge(tmp3, tmp2, by =&quot;name&quot;)
setnames(tmp4,  &quot;name&quot;, &quot;V2&quot;)
tmp4[,m:=mean(c(value.x, value.y)) , by=c(&quot;V2&quot;,&quot;V1&quot;)]
evb &lt;- tmp4[order(id),list(V1,V2,m)]$m


# set plotting parameters
vs &lt;- 15# vertex.size
ec &lt;- &quot;grey&quot;#edge.color
elx &lt;- 2# edge.label.cex
elc &lt;- &quot;black&quot;#edge.label.color
vlc &lt;- 2#vertex.label.cex
ew &lt;- 2#edge.width
hd &lt;- paste(rep(&quot; &quot;,0), collapse=&quot;&quot;)
cm &lt;- 3
vc &lt;- &quot;orange&quot;# vertex.color

windows(width = 18, height=6)
#par(mfrow=c(1,3))

plot(g, edge.label=paste(hd, round(E(g)$weight,1)), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(a) Weights&quot;,cex.main=cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-5-1.png" alt="" /></p>

<pre><code>plot(g, edge.label=paste(hd, round(eb,1)),          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) Link based Betweenness&quot;,cex.main=cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-5-2.png" alt="" /></p>

<pre><code>V(g)$name &lt;- paste(vb)

plot(g, edge.label=paste(hd, round(evb,1)),          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(c) Node based Betweenness&quot; ,cex.main=cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-5-3.png" alt="" /></p>

<h2 id="bugs-features-special-experiences">Bugs/Features/Special experiences</h2>

<ul>
<li>demonstrate the parameter &lsquo;lay&rsquo; with setting it NULL</li>
<li>cutoff parameter</li>
<li>nodes need to be named for using induced.subgraph(), otherwise
problems in matching results</li>
</ul>

<h3 id="cutoff">cutoff</h3>

<p>stackoverflow:
<a href="http://stackoverflow.com/questions/34180036/how-does-the-cutoff-parameter-influence-betweenness-calculation">http://stackoverflow.com/questions/34180036/how-does-the-cutoff-parameter-influence-betweenness-calculation</a></p>

<p>discussion:
<a href="https://lists.nongnu.org/archive/html/igraph-help/2012-11/msg00083.html">https://lists.nongnu.org/archive/html/igraph-help/2012-11/msg00083.html</a></p>

<p>github project:
<a href="https://github.com/maxar/igraph_testing/blob/master/test_vertex_betweenness_local.R">https://github.com/maxar/igraph_testing/blob/master/test_vertex_betweenness_local.R</a></p>

<pre><code>require(igraph)
packageVersion(&quot;igraph&quot;) # my installed version is 1.0.1

## [1] '1.0.1'

#----------------------------------------------------------------------------------------
#---------------    EXAMPLE 1    --------------------------------------------------------
#----------------------------------------------------------------------------------------

#--- set plotting parameters
vs &lt;- 25# vertex.size
ec &lt;- gray(0.8)#edge.color
elx &lt;- 2# edge.label.cex
elc &lt;- &quot;black&quot;#,edge.label.color
vlc &lt;- 2#vertex.label.cex
ew &lt;- 2#edge.width
cm &lt;- 2
vc &lt;- &quot;orange&quot;


g &lt;- make_graph(c(1, 2, 2, 3, 3, 4, 4,5, 5, 6, 6, 7) , directed = FALSE)

set.seed(1210)
lay &lt;- layout.auto(g)

graphics.off()
windows(width = 30, height=10)
#par(mfrow=c(1,3))

V(g)$name &lt;- letters[1:length(V(g))]
g &lt;- set.edge.attribute(g, &quot;weight&quot;,  value= c(2,3,5,5,3,2))
plot(g, edge.label=round(E(g)$weight,1), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(a) Weights&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-6-1.png" alt="" /></p>

<pre><code>bl.1 &lt;- estimate_betweenness(g, cutoff=10)
V(g)$name &lt;- bl.1
plot(g,        layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) Local Betweenness\ncutoff 10&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-6-2.png" alt="" /></p>

<pre><code>bl.2 &lt;- estimate_betweenness(g, cutoff=Inf)
V(g)$name &lt;- bl.2
plot(g,        layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) Global Betweenness\ncutoff Inf&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-6-3.png" alt="" /></p>

<pre><code># Comments and Discussion:
# This simple example illustrates, why it is questionable
# that the cutoff parameter actually measures distance independent of the edge weights
#
# 1. define edge weights as in plot (a)
# 2. calculate vertex betweenness with cutoff 10 (b)
# 3. calculate vertex betweenness with cutoff Inf (c)






#----------------------------------------------------------------------------------------
#---------------    EXAMPLE 2    --------------------------------------------------------
#----------------------------------------------------------------------------------------

#--- set plotting parameters
vs &lt;- 25# vertex.size
ec &lt;- gray(0.8)#edge.color
elx &lt;- 2# edge.label.cex
elc &lt;- &quot;black&quot;#,edge.label.color
vlc &lt;- 2#vertex.label.cex
ew &lt;- 2#edge.width
cm &lt;- 2
vc &lt;- &quot;orange&quot;


set.seed(1210)
g &lt;- make_ring(8)
lay &lt;- layout.auto(g)

graphics.off()
windows(width = 12, height=12)
par(mfrow=c(2,2))

V(g)$name &lt;- letters[1:length(V(g))]
g &lt;- set.edge.attribute(g, &quot;weight&quot;, value= c(.1 , .2, rep(.1, 2), rep(0.2,4)))
plot(g, edge.label=round(E(g)$weight,1), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(a) Weights&quot;, cex.main = cm)

bl.1 &lt;- estimate_betweenness(g, cutoff=0.29)
V(g)$name &lt;- bl.1
plot(g,        layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) Local Betweenness\ncutoff 0.29&quot;, cex.main = cm)

V(g)$name &lt;- letters[1:length(V(g))]
g &lt;- set.edge.attribute(g, &quot;weight&quot;, value=.2)
plot(g, edge.label=round(E(g)$weight,1), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(c) new weights&quot;, cex.main = cm)

bl.2 &lt;- estimate_betweenness(g, cutoff=0.29)
V(g)$name &lt;- bl.2
plot(g,          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(d) Local Betweenness\ncutoff 0.29&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-6-4.png" alt="" /></p>

<pre><code># Comments and Discussion:
# This simple example illustrates, that vertex betweenness values change,
# if the edge weights are changed and the cutoff parameters are chosen constant.
# Ring shape to reconstruct the calculation easier;
#
# 1. define edge weights as in plot (a)
# 2. calculate vertex betweenness with cutoff 0.29 (b)
# 3. define new edge weights as in plot (c)
# 4. calculate vertex betweenness with cutoff 0.29 (d)





#----------------------------------------------------------------------------------------
#---------------    EXAMPLE 3    --------------------------------------------------------
#----------------------------------------------------------------------------------------

#--- set plotting parameters
vs &lt;- 20# vertex.size
ec &lt;- gray(0.8)#edge.color
elx &lt;- 1# edge.label.cex
elc &lt;- &quot;black&quot;#,edge.label.color
vlc &lt;- 1#vertex.label.cex
ew &lt;- 2#edge.width
cm &lt;- 2
vc &lt;- &quot;orange&quot;


set.seed(1210)
g &lt;- make_ring(20)
lay &lt;- layout.auto(g)

graphics.off()
#windows(width = 30, height=30)
#par(mfrow=c(2,2))

V(g)$name &lt;- letters[1:length(V(g))]
g &lt;- set.edge.attribute(g, &quot;weight&quot;, value= c(rep(2:3,10)))
plot(g, edge.label=round(E(g)$weight,1), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(a) Weights&quot;, cex.main = cm)

bl.1 &lt;- estimate_betweenness(g, cutoff=6)
V(g)$name &lt;- bl.1
plot(g,        layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) Local Betweenness\ncutoff 6&quot;, cex.main = cm)

bl.2 &lt;- estimate_betweenness(g, cutoff=9)
V(g)$name &lt;- bl.2
plot(g,        layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(c) Local Betweenness\ncutoff 9&quot;, cex.main = cm)

bl.3 &lt;- estimate_betweenness(g, cutoff=Inf)
V(g)$name &lt;- bl.3
plot(g,          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(d) Global Betweenness\ncutoff Inf&quot;, cex.main = cm)


# Comments and Discussion:
# This simple example illustrates, that vertex betweenness values change,
# if the edge weights are constant and the cutoff parameters change.
# Ring shape to reconstruct the calculation easier;
#
# 1. define edge weights as in plot (a)
# 2. calculate vertex betweenness with cutoff 6 (b)
# 3. calculate vertex betweenness with cutoff 9 (c)
# 4. calculate vertex betweenness with cutoff Inf (d)
</code></pre>

<h3 id="normalization">normalization</h3>

<p>stackoverflow:
<a href="http://stackoverflow.com/questions/34000326/normalized-local-closeness-centrality-in-r-igraphestimate-closeness">http://stackoverflow.com/questions/34000326/normalized-local-closeness-centrality-in-r-igraphestimate-closeness</a></p>

<p>I am trying to calculate a normalized local closeness centrality. But
setting the parameter &lsquo;normalized = T&rsquo; for igraph::estimate_closeness()
only multiplies the results with (N-1). Is it possible to define N_i
for vertex i individually by it&rsquo;s neighborhood, that is determined by
the cut-off parameter (and of course by the graph itself)?</p>

<p>The mini example demonstrates, that setting the parameter &lsquo;normalized=T&rsquo;
does not work for this purpose. It normalizes with one and the same
(N-1) for all vertices.</p>

<p>Thanks for help.</p>

<pre><code>set.seed(1210)
require('igraph')
g &lt;- random.graph.game(20,3/10)
g &lt;- set.edge.attribute(g, &quot;weight&quot;,  value= 1)
cnt &lt;- estimate_closeness(g, cutoff = 3, normalized = T );cnt

##  [1] 0.6333333 0.2467532 0.3220339 0.5000000 0.5277778 0.5588235 0.6129032
##  [8] 0.5135135 0.5428571 0.5588235 0.4634146 0.5277778 0.6129032 0.5000000
## [15] 0.6333333 0.5000000 0.3392857 0.5135135 0.5135135 0.5135135

cnf &lt;- estimate_closeness(g, cutoff = 3, normalized = F );cnf

##  [1] 0.03333333 0.01298701 0.01694915 0.02631579 0.02777778 0.02941176
##  [7] 0.03225806 0.02702703 0.02857143 0.02941176 0.02439024 0.02777778
## [13] 0.03225806 0.02631579 0.03333333 0.02631579 0.01785714 0.02702703
## [19] 0.02702703 0.02702703

#print results
cbind(cnf * (length(V(g))-1), cnt)

##                       cnt
##  [1,] 0.6333333 0.6333333
##  [2,] 0.2467532 0.2467532
##  [3,] 0.3220339 0.3220339
##  [4,] 0.5000000 0.5000000
##  [5,] 0.5277778 0.5277778
##  [6,] 0.5588235 0.5588235
##  [7,] 0.6129032 0.6129032
##  [8,] 0.5135135 0.5135135
##  [9,] 0.5428571 0.5428571
## [10,] 0.5588235 0.5588235
## [11,] 0.4634146 0.4634146
## [12,] 0.5277778 0.5277778
## [13,] 0.6129032 0.6129032
## [14,] 0.5000000 0.5000000
## [15,] 0.6333333 0.6333333
## [16,] 0.5000000 0.5000000
## [17,] 0.3392857 0.3392857
## [18,] 0.5135135 0.5135135
## [19,] 0.5135135 0.5135135
## [20,] 0.5135135 0.5135135

sum(abs(cnf * (length(V(g))-1) - cnt))

## [1] 8.326673e-17

#for visualization
V(g)$name &lt;- paste(&quot;v&quot;, 1:length(V(g)), sep=&quot;&quot;)#letters[1:length(V(g))]
set.seed(2)
lay &lt;- layout.auto(g)

## set plotting parameters
vs &lt;- 15# vertex.size
ec &lt;- gray(0.8)#edge.color
elx &lt;- 2# edge.label.cex
elc &lt;- &quot;black&quot;#,edge.label.color
vlc &lt;- 2#vertex.label.cex
ew &lt;- 2#edge.width
hd &lt;- paste(rep(&quot; &quot;,0), collapse=&quot;&quot;)
cm &lt;- 3
vc &lt;- &quot;orange&quot;#gray(0.8)#palette(&quot;default&quot;)#&quot;grey&quot;#vertex.color

windows(width = 18, height=6)
#par(mfrow=c(1,3))

plot(g, edge.label=paste(hd, round(E(g)$weight,1)), layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(a) Weights&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-7-1.png" alt="" /></p>

<pre><code>V(g)$name &lt;- paste(round(cnt,3))
plot(g,          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(b) local closeness normalized&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-7-2.png" alt="" /></p>

<pre><code>V(g)$name &lt;- paste(round(cnf,3))
plot(g,          layout=lay, vertex.size=vs, edge.color=ec, edge.label.cex=elx, vertex.label.cex=vlc, edge.width=ew, edge.label.color=elc, vertex.color=vc)
title(&quot;(c) local closeness&quot;, cex.main = cm)
</code></pre>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/unnamed-chunk-7-3.png" alt="" /></p>

<h4 id="my-solution">My solution</h4>

<p>easy workaround for local centralities: define neighborhood for each
node, calcualte &lsquo;global&rsquo; centralities for these neighborhoods and
normalize it individually.</p>

<h1 id="what-for-did-we-use-centralities">What for did we use centralities?</h1>

<p>Thanks to Anita Graser for the beautiful plots!</p>

<p>$$\hat{y}_{t,\gamma}(s,b,c) = \beta_t  + \beta_{\gamma,s} \cdot s  + \beta_{\gamma,b} \cdot b + \beta_{\gamma,c} \cdot c + \beta_{\gamma,bc} \cdot b \cdot c$$</p>

<p>some plots:</p>

<h2 id="global-betweenness">Global Betweenness</h2>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic1.png" title="**Global Betweenness** \
*Global Betweenness*" alt="**Global Betweenness** \
*Global Betweenness*" style='width:100%;' border="0" /></p>

<h2 id="local-betweenness">Local Betweenness</h2>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic2.png" title="**Local Betweenness** \
*Local Betweenness*" alt="**Local Betweenness** \
*Local Betweenness*" style='width:100%;' border="0" /></p>

<h2 id="global-closeness">Global Closeness</h2>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic3.png" title="**Global Closeness** \
*Global Closeness*" alt="**Global Closeness** \
*Global Closeness*" style='width:100%;' border="0" /></p>

<h2 id="local-closeness">Local Closeness</h2>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic4.png" title="**Local Closeness** \
*Local Closeness*" alt="**Local Closeness** \
*Local Closeness*" style='width:100%;' border="0" /></p>

<h2 id="real-world-difference-of-node-based-and-link-based-betweenness-for-a-link">Real world difference of node-based and link-based Betweenness for a link</h2>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic5.png" title="**Real world difference 1** \
*Real world difference 1*" alt="**Real world difference 1** \
*Real world difference 1*" style='width:100%;' border="0" /></p>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic6.png" title="**Real world difference 2** \
*Real world difference 2*" alt="**Real world difference 2** \
*Real world difference 2*" style='width:100%;' border="0" /></p>

<h2 id="improvement-travel-time-model">Improvement travel time model</h2>

<h3 id="mape-difference-global-minus-local">MAPE Difference Global minus local</h3>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic7.png" title="**MAPE Difference** \
*MAPE Difference*" alt="**MAPE Difference** \
*MAPE Difference*" style='width:100%;' border="0" /></p>

<h3 id="detail-mape-base">Detail MAPE base</h3>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic8.png" title="**MAPE base** \
*MAPE base*" alt="**MAPE base** \
*MAPE base*" style='width:100%;' border="0" /></p>

<h3 id="detail-mape-with-local-centralities">Detail MAPE with local centralities</h3>

<p><img src="/img/20160524_igraph_applications_files/figure-markdown_strict/pic9.png" title="**MAPE local** \
*MAPE local*" alt="**MAPE local** \ *MAPE local*" style='width:100%;' border="0" /></p>
            </div>

            <aside>
                
                <ul class="list-inline post-tags">
                    
                    <li>
                        <a href="http://www.viennar.org//tags/igraph">
                            <i class="fa fa-tags"></i>
                            igraph
                        </a>
                    </li>
                    
                    <li>
                        <a href="http://www.viennar.org//tags/rstudy">
                            <i class="fa fa-tags"></i>
                            rstudy
                        </a>
                    </li>
                    
                </ul>

                
                
                <h3>Related Post</h3>
                <ul class="post-rels">
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li><a href="http://www.viennar.org/blog/2016/02/24/wordcloud-wienerwald/">Wordcloud Wienerwald</a></li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li><a href="http://www.viennar.org/blog/2015/11/08/bike-parking-lots-in-vienna/">Bike Parking Lots in Vienna</a></li>
                    
                    
                    
                    
                    
                    <li><a href="http://www.viennar.org/blog/2015/10/30/population-densities-in-vienna/">Population Densities in Vienna</a></li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </aside>
            
            
            <footer>

                <nav>
                    <ul class="pager">

                        
                        <li class="previous"><a href="http://www.viennar.org/blog/2016/09/27/meetup-09-2016-minutes/"><span aria-hidden="true">&larr;</span> Older</a></li>
                        

                        <li><a href="http://www.viennar.org//post">All Posts</a></li>

                        
                        <li class="next"><a href="http://www.viennar.org/blog/2016/06/28/meetup-06-2016-minutes/">Newer <span aria-hidden="true">&rarr;</span></a></li>
                        

                    </ul>
                </nav>

                
                
                
            </footer>

        </article>
    </div>
    <div class="col-md-4">
        
<aside>
    <div class="row">

        <div class="col-xs-12 col-sm-4 col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Recent Posts</h2>
                </div>
                <div class="list-group">
                    
                    <a href="/blog/2016/11/22/meetup-11-2016-minutes/" class="list-group-item">Meetup 11-2016 Minutes</a>
                    
                    <a href="/blog/2016/10/19/meetup-10-2016-minutes/" class="list-group-item">Meetup 10-2016 Minutes</a>
                    
                    <a href="/blog/2016/09/27/meetup-09-2016-minutes/" class="list-group-item">Meetup 09-2016 Minutes</a>
                    
                    <a href="/blog/2016/08/24/igraph-applications-for-transportation-networks/" class="list-group-item">igraph Applications for Transportation Networks</a>
                    
                    <a href="/blog/2016/06/28/meetup-06-2016-minutes/" class="list-group-item">Meetup 06-2016 Minutes</a>
                    
                    <a href="/blog/2016/05/24/meetup-05-2016-minutes/" class="list-group-item">Meetup 05-2016 Minutes</a>
                    
                    <a href="/blog/2016/05/06/meetup-04-2016-minutes/" class="list-group-item">Meetup 04-2016 Minutes</a>
                    
                    <a href="/blog/2016/02/24/wordcloud-wienerwald/" class="list-group-item">Wordcloud Wienerwald</a>
                    
                    <a href="/blog/2016/02/22/meetup-02-2016-minutes/" class="list-group-item">Meetup 02-2016 Minutes</a>
                    
                    <a href="/blog/2016/02/03/meetup-01-2016-minutes/" class="list-group-item">Meetup 01-2016 Minutes</a>
                    
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-4 col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Tags</h2>
                </div>
                <div class="list-group">
                    
                    
                    
                    <a href="http://www.viennar.org//tags/igraph" class="list-group-item">
                        <span class="badge">1</span>
                        igraph
                    </a>
                    
                    
                    <a href="http://www.viennar.org//tags/meetup" class="list-group-item">
                        <span class="badge">12</span>
                        meetup
                    </a>
                    
                    
                    <a href="http://www.viennar.org//tags/opengovernmentvienna" class="list-group-item">
                        <span class="badge">2</span>
                        opengovernmentvienna
                    </a>
                    
                    
                    <a href="http://www.viennar.org//tags/rstudy" class="list-group-item">
                        <span class="badge">4</span>
                        rstudy
                    </a>
                    
                    
                    <a href="http://www.viennar.org//tags/text-mining" class="list-group-item">
                        <span class="badge">1</span>
                        text-mining
                    </a>
                    
                </div>
            </div>
        </div>

    </div>
</aside>

    </div>
</div>

</div>
<hr>

<footer class="container copy">
    <p>&copy; 2016  <a href="mailto:host@viennar.org">Vienna-R</a> </p>
</footer>

<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="//yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-69538956-1', 'auto');
ga('send', 'pageview');

</script>

<script>
document.write('<script src="//sharebutton.net/plugin/sharebutton.php?type=horizontal&u=' + encodeURIComponent(document.location.href) + '"></scr' + 'ipt>');
</script>

